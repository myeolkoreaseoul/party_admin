<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ë­˜ ì¢€ ì•„ëŠ” ì‚¬ëŒë“¤ - íŒŒí‹° ë¼ì¸ì—…">
    <title>ë­˜ ì¢€ ì•„ëŠ” ì‚¬ëŒë“¤ - íŒŒí‹° ë¼ì¸ì—…</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <style>
        :root {
            --color-bg: #0a0a0a;
            --color-card: #151515;
            --color-border: #2a2a2a;
            --color-text: #ffffff;
            --color-text-muted: #888888;
            --color-gold: #FFD700;
            --color-male: #4a9eff;
            --color-female: #ff6b9d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 1px solid var(--color-border);
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-gold);
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: var(--color-text-muted);
            font-size: 14px;
        }
        
        /* íŒŒí‹° ì„ íƒ */
        .party-selector {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .party-selector select {
            background: var(--color-card);
            border: 1px solid var(--color-border);
            color: var(--color-text);
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }
        
        .party-selector select:focus {
            outline: none;
            border-color: var(--color-gold);
        }
        
        /* íŒŒí‹° ì •ë³´ ì¹´ë“œ */
        .party-info {
            background: var(--color-card);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }
        
        .party-info h2 {
            font-size: 24px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .party-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
        }
        
        .stat-item {
            text-align: center;
            padding: 16px;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-gold);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--color-text-muted);
            margin-top: 4px;
        }
        
        /* ë¼ì¸ì—… ê·¸ë¦¬ë“œ */
        .lineup-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        @media (max-width: 768px) {
            .lineup-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .lineup-section {
            background: var(--color-card);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            overflow: hidden;
        }
        
        .lineup-header {
            padding: 20px;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .lineup-header.male {
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.1), transparent);
        }
        
        .lineup-header.female {
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.1), transparent);
        }
        
        .lineup-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .lineup-count {
            font-size: 14px;
            color: var(--color-text-muted);
        }
        
        /* ì°¸ì—¬ì ë¦¬ìŠ¤íŠ¸ */
        .participant-list {
            padding: 16px;
        }
        
        .participant-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: rgba(255,255,255,0.02);
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }
        
        .participant-item:hover {
            background: rgba(255,255,255,0.05);
        }
        
        .participant-item.pending {
            opacity: 0.7;
        }
        
        .participant-rank {
            width: 30px;
            height: 30px;
            background: var(--color-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
        }
        
        .participant-info {
            flex: 1;
        }
        
        .participant-job {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }
        
        .participant-details {
            font-size: 12px;
            color: var(--color-text-muted);
        }
        
        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--color-text-muted);
        }
        
        /* ë¡œë”© */
        .loading {
            text-align: center;
            padding: 60px;
            color: var(--color-text-muted);
        }
        
        .loading i {
            font-size: 32px;
            margin-bottom: 16px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* í‘¸í„° */
        footer {
            text-align: center;
            padding: 40px;
            color: var(--color-text-muted);
            font-size: 12px;
            border-top: 1px solid var(--color-border);
            margin-top: 40px;
        }
        
        /* ë³µì‚¬ ë²„íŠ¼ */
        .copy-btn {
            background: var(--color-gold);
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 20px auto;
            transition: all 0.2s;
        }
        
        .copy-btn:hover {
            background: #e6c200;
            transform: translateY(-2px);
        }
        
        .copy-btn:active {
            transform: translateY(0);
        }
        
        /* í† ìŠ¤íŠ¸ */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .toast.success {
            background: #2e7d32;
        }
        
        .toast.error {
            background: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">ë­˜ ì¢€ ì•„ëŠ” ì‚¬ëŒë“¤</div>
            <div class="subtitle">í”„ë¦¬ë¯¸ì—„ ì†Œì…œ ì´ë²¤íŠ¸ ë¼ì¸ì—…</div>
        </header>
        
        <div class="party-selector">
            <select id="partyDateSelect">
                <option value="">ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
            </select>
            <select id="partySessionSelect">
                <option value="">ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”</option>
            </select>
        </div>
        
        <div id="partyInfo" class="party-info" style="display: none;">
            <h2 id="partyTitle">
                <span id="partyIcon">â˜•</span>
                <span id="partyName">íŒŒí‹° ì •ë³´</span>
            </h2>
            <div class="party-stats">
                <div class="stat-item">
                    <div class="stat-value" id="statTotal">-</div>
                    <div class="stat-label">ì´ ì¸ì›</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statMale" style="color: var(--color-male);">-</div>
                    <div class="stat-label">ë‚¨ì</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statFemale" style="color: var(--color-female);">-</div>
                    <div class="stat-label">ì—¬ì</div>
                </div>
            </div>
        </div>
        
        <button class="copy-btn" id="copyBtn" style="display: none;" onclick="copyLineupText()">
            <i class="fas fa-copy"></i> ë¼ì¸ì—… í…ìŠ¤íŠ¸ ë³µì‚¬
        </button>
        
        <div id="loadingState" class="loading">
            <i class="fas fa-spinner"></i>
            <p>ë°ì´í„° ë¡œë”© ì¤‘...</p>
        </div>
        
        <div id="lineupContent" class="lineup-grid" style="display: none;">
            <div class="lineup-section">
                <div class="lineup-header male">
                    <span class="lineup-title">ğŸ‘¨ ë‚¨ì ë¼ì¸ì—…</span>
                    <span class="lineup-count" id="maleCount">0ëª…</span>
                </div>
                <div class="participant-list" id="maleList">
                    <div class="empty-state">ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤</div>
                </div>
            </div>
            
            <div class="lineup-section">
                <div class="lineup-header female">
                    <span class="lineup-title">ğŸ‘© ì—¬ì ë¼ì¸ì—…</span>
                    <span class="lineup-count" id="femaleCount">0ëª…</span>
                </div>
                <div class="participant-list" id="femaleList">
                    <div class="empty-state">ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤</div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Â© 2026 ë­˜ ì¢€ ì•„ëŠ” ì‚¬ëŒë“¤. All rights reserved.</p>
            <p style="margin-top: 8px;">ë¼ì¸ì—… ì •ë³´ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.</p>
        </footer>
    </div>
    
    <div id="toast" class="toast"></div>
    
    <script>
        // ============================================
        // Supabase ì„¤ì • (ê³µê°œ í‚¤ë§Œ ì‚¬ìš© - ë¯¼ê°ì •ë³´ ì ‘ê·¼ ë¶ˆê°€)
        // ============================================
        const SUPABASE_URL = 'https://bqpxdxsgxoapguknxwul.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxcHhkeHNneG9hcGd1a254d3VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1MjUyNDAsImV4cCI6MjA4MzEwMTI0MH0.v_r3wIIIe024k-H-9dyHH-LJj73kP9iU_eYgHZX7CGA';
        const API_BASE = `${SUPABASE_URL}/rest/v1`;
        const PUBLIC_LINEUP_TABLE = 'public_lineup';
        
        // Supabase í—¤ë” (ê³µê°œ í‚¤ - ì½ê¸°ë§Œ ê°€ëŠ¥)
        const SUPABASE_HEADERS = {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
        };
        
        // ë°ì´í„° ì €ì¥ì†Œ
        let data = {
            publicLineup: [],
            partyTypes: [],
            schedules: []
        };
        
        // í˜„ì¬ ì„ íƒëœ ë¼ì¸ì—… ë°ì´í„° (ë³µì‚¬ìš©)
        let currentLineup = {
            date: '',
            part: '',
            males: [],
            females: []
        };
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async () => {
            await loadAllData();
            setupEventListeners();
        });
        
        // ë°ì´í„° ë¡œë“œ (ê³µê°œ í…Œì´ë¸”ë§Œ)
        async function loadAllData() {
            try {
                const [publicLineup, schedules, partyTypes] = await Promise.all([
                    fetchTable(PUBLIC_LINEUP_TABLE),
                    fetchTable('party_schedules'),
                    fetchTable('party_types')
                ]);
                
                data.publicLineup = publicLineup;
                data.schedules = schedules;
                data.partyTypes = partyTypes;
                
                populateDateSelect();
                document.getElementById('loadingState').style.display = 'none';
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('loadingState').innerHTML = '<p>ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }
        
        async function fetchTable(tableName) {
            try {
                const response = await fetch(`${API_BASE}/${tableName}?select=*`, {
                    headers: SUPABASE_HEADERS
                });
                if (!response.ok) return [];
                const result = await response.json();
                // SupabaseëŠ” ë°°ì—´ ì§ì ‘ ë°˜í™˜, snake_case â†’ camelCase ë³€í™˜
                return (result || []).map(row => {
                    const newRow = {};
                    for (const key in row) {
                        const camelKey = key.replace(/_([a-z])/g, (_, l) => l.toUpperCase());
                        newRow[camelKey] = row[key];
                    }
                    return newRow;
                });
            } catch {
                return [];
            }
        }
        
        // ë‚ ì§œ ì„ íƒ ëª©ë¡ ìƒì„±
        function populateDateSelect() {
            const select = document.getElementById('partyDateSelect');
            
            // public_lineupì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë‚ ì§œ ì¶”ì¶œ (ìŠ¤í‚¤ë§ˆ: scheduleDate)
            const uniqueDates = [...new Set(data.publicLineup.map(p => p.scheduleDate))];
            
            // ë¯¸ë˜ ë‚ ì§œë§Œ í•„í„°ë§
            const futureDates = uniqueDates.filter(date => getDaysUntil(date) >= 0);
            
            futureDates.sort((a, b) => {
                return parseDateForComparison(a).localeCompare(parseDateForComparison(b));
            });
            
            select.innerHTML = '<option value="">ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
            futureDates.forEach(date => {
                const dayName = getDayOfWeek(date);
                select.innerHTML += `<option value="${date}">${date} (${dayName})</option>`;
            });
            
            // ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
            if (futureDates.length === 0) {
                select.innerHTML = '<option value="">ê³µê°œëœ ë¼ì¸ì—…ì´ ì—†ìŠµë‹ˆë‹¤</option>';
            }
        }
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            document.getElementById('partyDateSelect').addEventListener('change', updateSessionSelect);
            document.getElementById('partySessionSelect').addEventListener('change', renderLineup);
        }
        
        // ì„¸ì…˜ ì„ íƒ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateSessionSelect() {
            const dateValue = document.getElementById('partyDateSelect').value;
            const sessionSelect = document.getElementById('partySessionSelect');
            
            if (!dateValue) {
                sessionSelect.innerHTML = '<option value="">ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”</option>';
                document.getElementById('partyInfo').style.display = 'none';
                document.getElementById('lineupContent').style.display = 'none';
                document.getElementById('copyBtn').style.display = 'none';
                return;
            }
            
            // public_lineupì—ì„œ í•´ë‹¹ ë‚ ì§œì˜ ì„¸ì…˜ ì¶”ì¶œ (ìŠ¤í‚¤ë§ˆ: scheduleDate, schedulePart)
            const sessionsForDate = [...new Set(
                data.publicLineup
                    .filter(p => normalizeDateStr(p.scheduleDate) === normalizeDateStr(dateValue))
                    .map(p => p.schedulePart)
            )];
            
            // 1ë¶€, 2ë¶€, 3ë¶€ ìˆœìœ¼ë¡œ ì •ë ¬
            const partOrder = { '1ë¶€': 1, '2ë¶€': 2, '3ë¶€': 3 };
            sessionsForDate.sort((a, b) => (partOrder[a] || 99) - (partOrder[b] || 99));
            
            sessionSelect.innerHTML = '<option value="">ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            sessionsForDate.forEach(part => {
                // ì¼ì •ì—ì„œ ì‹œê°„ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const schedule = data.schedules.find(s => 
                    normalizeDateStr(s.date) === normalizeDateStr(dateValue) && s.part === part
                );
                const time = schedule?.time || '';
                const partyType = data.partyTypes.find(t => t.id === schedule?.partyType);
                const icon = partyType?.icon || 'â˜•';
                sessionSelect.innerHTML += `<option value="${part}">${part} ${time ? '(' + time + ')' : ''} ${icon}</option>`;
            });
        }
        
        // ë¼ì¸ì—… ë Œë”ë§
        function renderLineup() {
            const dateValue = document.getElementById('partyDateSelect').value;
            const sessionValue = document.getElementById('partySessionSelect').value;
            
            if (!dateValue || !sessionValue) {
                document.getElementById('partyInfo').style.display = 'none';
                document.getElementById('lineupContent').style.display = 'none';
                document.getElementById('copyBtn').style.display = 'none';
                return;
            }
            
            // public_lineupì—ì„œ í•´ë‹¹ ë‚ ì§œ/ì„¸ì…˜ì˜ ì°¸ì—¬ì í•„í„°ë§ (ìŠ¤í‚¤ë§ˆ: scheduleDate, schedulePart)
            const normalizedDate = normalizeDateStr(dateValue);
            const participants = data.publicLineup.filter(p => 
                normalizeDateStr(p.scheduleDate) === normalizedDate && p.schedulePart === sessionValue
            );
            
            // ì„±ë³„ ë¶„ë¥˜
            const males = participants.filter(p => p.gender === 'ë‚¨ì');
            const females = participants.filter(p => p.gender === 'ì—¬ì');
            
            // displayOrderë¡œ ì •ë ¬
            males.sort((a, b) => (a.displayOrder || 999) - (b.displayOrder || 999));
            females.sort((a, b) => (a.displayOrder || 999) - (b.displayOrder || 999));
            
            // í˜„ì¬ ë¼ì¸ì—… ì €ì¥ (ë³µì‚¬ìš©)
            currentLineup = {
                date: dateValue,
                part: sessionValue,
                males: males,
                females: females
            };
            
            // ì¼ì • ì •ë³´ ê°€ì ¸ì˜¤ê¸° (íŒŒí‹° ìœ í˜• í‘œì‹œìš©)
            const schedule = data.schedules.find(s => 
                normalizeDateStr(s.date) === normalizedDate && s.part === sessionValue
            );
            const partyType = schedule ? data.partyTypes.find(t => t.id === schedule.partyType) : null;
            
            // íŒŒí‹° ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById('partyInfo').style.display = 'block';
            document.getElementById('lineupContent').style.display = 'grid';
            document.getElementById('copyBtn').style.display = 'flex';
            
            const icon = partyType?.icon || 'â˜•';
            document.getElementById('partyIcon').textContent = icon;
            document.getElementById('partyName').textContent = `${partyType?.name || 'íŒŒí‹°'} - ${sessionValue}`;
            
            document.getElementById('statTotal').textContent = males.length + females.length;
            document.getElementById('statMale').textContent = males.length;
            document.getElementById('statFemale').textContent = females.length;
            
            // ë¼ì¸ì—… ë Œë”ë§
            document.getElementById('maleCount').textContent = `${males.length}ëª…`;
            document.getElementById('femaleCount').textContent = `${females.length}ëª…`;
            
            renderParticipantList('maleList', males);
            renderParticipantList('femaleList', females);
        }
        
        // ì°¸ì—¬ì ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
        function renderParticipantList(containerId, participants) {
            const container = document.getElementById(containerId);
            
            if (participants.length === 0) {
                container.innerHTML = '<div class="empty-state">ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }
            
            container.innerHTML = participants.map((p, idx) => {
                // public_lineupì—ëŠ” ageRange, height, jobë§Œ ìˆìŒ (tier, type ì—†ìŒ)
                const ageRange = p.ageRange || '-';
                const height = p.height ? `${p.height}cm` : '-';
                const job = p.job || '-';
                
                return `
                    <div class="participant-item">
                        <div class="participant-rank">${idx + 1}</div>
                        <div class="participant-info">
                            <div class="participant-job">${job}</div>
                            <div class="participant-details">${ageRange} Â· ${height}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // ë¼ì¸ì—… í…ìŠ¤íŠ¸ ë³µì‚¬ (í”„ë¦½ ìƒì„¸í˜ì´ì§€ìš©)
        function copyLineupText() {
            if (currentLineup.males.length === 0 && currentLineup.females.length === 0) {
                showToast('ë³µì‚¬í•  ë¼ì¸ì—…ì´ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            let text = `[${currentLineup.date} ${currentLineup.part}]\n\n`;
            
            // ë‚¨ì ë¼ì¸ì—…
            if (currentLineup.males.length > 0) {
                text += `ğŸ‘¨ ë‚¨ì (${currentLineup.males.length}ëª…)\n`;
                currentLineup.males.forEach((p, idx) => {
                    const height = p.height ? `${p.height}cm` : '';
                    const ageRange = p.ageRange || '';
                    const job = p.job || '';
                    text += `${idx + 1}. ${job} / ${ageRange}${height ? ' / ' + height : ''}\n`;
                });
                text += '\n';
            }
            
            // ì—¬ì ë¼ì¸ì—…
            if (currentLineup.females.length > 0) {
                text += `ğŸ‘© ì—¬ì (${currentLineup.females.length}ëª…)\n`;
                currentLineup.females.forEach((p, idx) => {
                    const height = p.height ? `${p.height}cm` : '';
                    const ageRange = p.ageRange || '';
                    const job = p.job || '';
                    text += `${idx + 1}. ${job} / ${ageRange}${height ? ' / ' + height : ''}\n`;
                });
            }
            
            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(text).then(() => {
                showToast('ë¼ì¸ì—…ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                showToast('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            });
        }
        
        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // ============================================
        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        // ============================================
        
        // ë‚ ì§œ ì •ê·œí™” ("2026ë…„ 1ì›” 11ì¼", "2026ë…„  1ì›”  11ì¼" ë“±ì„ í†µì¼)
        function normalizeDateStr(d) {
            if (!d) return '';
            const match = d.match(/(\d{4})ë…„\s*(\d{1,2})ì›”\s*(\d{1,2})ì¼/);
            if (match) {
                return `${match[1]}ë…„ ${parseInt(match[2])}ì›” ${parseInt(match[3])}ì¼`;
            }
            return d;
        }
        
        function getDaysUntil(dateStr) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const match = dateStr?.match(/(\d{4})ë…„\s*(\d{1,2})ì›”\s*(\d{1,2})ì¼/);
            if (!match) return -999;
            const targetDate = new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
            return Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));
        }
        
        function parseDateForComparison(dateStr) {
            const match = dateStr?.match(/(\d{4})ë…„\s*(\d{1,2})ì›”\s*(\d{1,2})ì¼/);
            if (!match) return dateStr || '';
            return `${match[1]}-${String(match[2]).padStart(2, '0')}-${String(match[3]).padStart(2, '0')}`;
        }
        
        function getDayOfWeek(dateStr) {
            const match = dateStr?.match(/(\d{4})ë…„\s*(\d{1,2})ì›”\s*(\d{1,2})ì¼/);
            if (!match) return '';
            const date = new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
            return ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][date.getDay()];
        }
    </script>
</body>
</html>
