<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ï¶ùÎπôÏûêÎ£å Ï≤®Î∂Ä - Î≠ò Ï¢Ä ÏïÑÎäî ÏÇ¨ÎûåÎì§</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #1A1A1A;
            --bg-secondary: #151515;
            --bg-dark: #101010;
            --gold: #FFD700;
            --gold-light: #FFE55C;
            --white: #FFFFFF;
            --gray-100: #F5F5F5;
            --gray-200: #EEEEEE;
            --gray-300: #E0E0E0;
            --gray-400: #BDBDBD;
            --gray-500: #9E9E9E;
            --gray-600: #757575;
            --gray-700: #616161;
            --gray-800: #424242;
            --gray-900: #212121;
            --neon-green: #39FF14;
            --error: #ff4444;
            --success: #00C851;
            --warning: #ffa726;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-primary);
            color: var(--white);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .verification-header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
            margin-bottom: 30px;
        }

        .verification-header h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 10px;
        }

        .verification-header p {
            color: var(--gray-400);
            font-size: 16px;
        }

        /* Selected Qualification Display */
        .selected-qualification {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .selected-qualification h3 {
            font-size: 14px;
            color: var(--gray-400);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .qualification-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 16px;
        }

        .qualification-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid var(--gold);
            border-radius: 30px;
            padding: 10px 16px;
            color: var(--gold);
            font-weight: 500;
            font-size: 14px;
        }

        .qualification-badge i {
            font-size: 16px;
        }

        .wine-bonus-banner {
            background: linear-gradient(135deg, rgba(128, 0, 128, 0.3), rgba(255, 215, 0, 0.2));
            border: 1px solid rgba(128, 0, 128, 0.5);
            border-radius: 12px;
            padding: 14px 20px;
            margin-top: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--white);
            font-size: 15px;
        }

        .wine-bonus-banner i {
            font-size: 24px;
            color: #9b59b6;
        }

        /* Sensitive Notice */
        .sensitive-notice {
            background: rgba(255, 167, 38, 0.15);
            border: 1px solid rgba(255, 167, 38, 0.4);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sensitive-notice i {
            font-size: 24px;
            color: var(--warning);
        }

        .sensitive-notice p {
            color: var(--warning);
            font-size: 14px;
            line-height: 1.5;
        }

        /* SNS Link Section */
        .sns-link-section {
            background: rgba(225, 48, 108, 0.1);
            border: 1px solid rgba(225, 48, 108, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .sns-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sns-section-title i {
            color: #E1306C;
        }

        .sns-platform-select {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 16px;
        }

        .platform-option {
            cursor: pointer;
        }

        .platform-option input {
            display: none;
        }

        .platform-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 13px;
            color: var(--gray-400);
            transition: all 0.2s;
        }

        .platform-option input:checked + .platform-label {
            background: rgba(225, 48, 108, 0.2);
            border-color: #E1306C;
            color: var(--white);
        }

        .platform-label:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .platform-label i {
            font-size: 16px;
        }

        .platform-option input[value="instagram"]:checked + .platform-label i { color: #E1306C; }
        .platform-option input[value="youtube"]:checked + .platform-label i { color: #FF0000; }
        .platform-option input[value="tiktok"]:checked + .platform-label i { color: #00F2EA; }
        .platform-option input[value="other"]:checked + .platform-label i { color: var(--gold); }

        .sns-input-wrapper {
            margin-top: 16px;
        }

        .sns-input-wrapper label {
            display: block;
            font-size: 14px;
            color: var(--white);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .sns-error {
            color: #ff4444;
            font-size: 13px;
            margin-top: 8px;
        }

        .input-hint {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 8px;
        }

        /* Auth Method Selection */
        .auth-method-section {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 24px;
        }

        .auth-method-section h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .auth-method-section h2 i {
            color: var(--gold);
        }

        .auth-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .auth-option {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-option:hover {
            border-color: rgba(255, 215, 0, 0.3);
            background: rgba(255, 215, 0, 0.05);
        }

        .auth-option.selected {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .auth-option input[type="radio"] {
            display: none;
        }

        .radio-custom {
            width: 24px;
            height: 24px;
            min-width: 24px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            margin-top: 2px;
        }

        .auth-option.selected .radio-custom {
            border-color: var(--gold);
            background: var(--gold);
        }

        .auth-option.selected .radio-custom::after {
            content: '';
            width: 10px;
            height: 10px;
            background: var(--bg-dark);
            border-radius: 50%;
        }

        .auth-option-content {
            flex: 1;
        }

        .auth-option-content h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .auth-option-content h4 i {
            color: var(--gold);
            font-size: 14px;
        }

        .auth-option-content p {
            font-size: 14px;
            color: var(--gray-400);
            line-height: 1.5;
        }

        .badge-recommended {
            background: var(--neon-green);
            color: var(--bg-dark);
            font-size: 10px;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 10px;
            text-transform: uppercase;
        }

        .badge-easy {
            background: var(--gold);
            color: var(--bg-dark);
            font-size: 10px;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 10px;
        }

        /* Upload Section */
        .upload-section {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 24px;
            display: none;
        }

        .upload-section.active {
            display: block;
        }

        .upload-section h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-section h2 i {
            color: var(--gold);
        }

        .upload-description {
            color: var(--gray-400);
            font-size: 14px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .required-docs {
            background: rgba(255, 215, 0, 0.05);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .required-docs h4 {
            font-size: 14px;
            color: var(--gold);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .required-docs ul {
            list-style: none;
        }

        .required-docs li {
            color: var(--gray-300);
            font-size: 14px;
            padding: 8px 0;
            padding-left: 24px;
            position: relative;
        }

        .required-docs li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--neon-green);
        }

        /* File Upload Area */
        .file-upload-area {
            border: 2px dashed rgba(255, 215, 0, 0.3);
            border-radius: 16px;
            padding: 40px 20px;
            text-align: center;
            background: rgba(255, 215, 0, 0.02);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-area:hover,
        .file-upload-area.dragover {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.08);
        }

        .file-upload-area i {
            font-size: 48px;
            color: var(--gold);
            margin-bottom: 16px;
        }

        .file-upload-area h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .file-upload-area p {
            color: var(--gray-500);
            font-size: 14px;
        }

        .file-upload-area input[type="file"] {
            display: none;
        }

        /* Uploaded Files List */
        .uploaded-files {
            margin-top: 20px;
        }

        .uploaded-file {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 14px 16px;
            margin-bottom: 10px;
        }

        .uploaded-file i.file-icon {
            font-size: 24px;
            color: var(--gold);
        }

        .uploaded-file .file-info {
            flex: 1;
        }

        .uploaded-file .file-name {
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }

        .uploaded-file .file-size {
            font-size: 12px;
            color: var(--gray-500);
        }

        .uploaded-file .remove-file {
            background: rgba(255, 68, 68, 0.2);
            border: none;
            color: var(--error);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .uploaded-file .remove-file:hover {
            background: rgba(255, 68, 68, 0.4);
        }

        .file-preview {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }

        /* Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ù ÏÑπÏÖò */
        .qualification-sections-container {
            margin-top: 20px;
        }

        .qualification-section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .qualification-section.sensitive {
            border-color: rgba(255, 167, 38, 0.4);
            background: rgba(255, 167, 38, 0.05);
        }

        .qual-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .qual-header i {
            font-size: 24px;
            color: var(--gold);
        }

        .qual-header-text h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 4px;
        }

        .qual-header-text p {
            font-size: 13px;
            color: var(--gray-400);
        }

        .sensitive-badge {
            background: rgba(255, 167, 38, 0.2);
            color: var(--warning);
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 4px;
            margin-left: auto;
        }

        /* Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ùÎ∞©Î≤ï ÏÑ†ÌÉù */
        .qual-auth-method {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .qual-auth-option {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .qual-auth-option:hover {
            border-color: rgba(255, 215, 0, 0.3);
        }

        .qual-auth-option.selected {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .qual-auth-option input {
            display: none;
        }

        .qual-auth-radio {
            width: 18px;
            height: 18px;
            border: 2px solid var(--gray-500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .qual-auth-option.selected .qual-auth-radio {
            border-color: var(--gold);
        }

        .qual-auth-option.selected .qual-auth-radio::after {
            content: '';
            width: 10px;
            height: 10px;
            background: var(--gold);
            border-radius: 50%;
        }

        .qual-auth-label {
            font-size: 14px;
            font-weight: 500;
        }

        .qual-auth-label i {
            margin-right: 6px;
            font-size: 14px;
        }

        /* ÌòÑÏû• Ïù∏Ï¶ù ÏïàÎÇ¥ */
        .onsite-info {
            display: none;
            padding: 14px 16px;
            background: rgba(57, 255, 20, 0.1);
            border: 1px solid rgba(57, 255, 20, 0.3);
            border-radius: 10px;
            font-size: 13px;
            color: var(--neon-green);
        }

        .onsite-info.active {
            display: block;
        }

        .onsite-info i {
            margin-right: 8px;
        }

        /* ÏóÖÎ°úÎìú ÌïÑÎìú ÏòÅÏó≠ */
        .qual-upload-fields {
            display: none;
        }

        .qual-upload-fields.active {
            display: block;
        }

        .qualification-field-group {
            background: transparent;
            border: none;
            padding: 0;
            margin-bottom: 0;
        }

        .qualification-field-group h4 {
            display: none;
        }

        .field-item {
            margin-bottom: 16px;
        }

        .field-item:last-child {
            margin-bottom: 0;
        }

        .field-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--white);
            margin-bottom: 8px;
        }

        .field-label .required-mark {
            color: var(--error);
            font-size: 12px;
        }

        .field-hint {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 6px;
        }

        .field-file-upload {
            border: 2px dashed rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            background: rgba(255, 215, 0, 0.02);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .field-file-upload:hover,
        .field-file-upload.dragover {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.06);
        }

        .field-file-upload.has-file {
            border-color: var(--success);
            background: rgba(0, 200, 81, 0.05);
        }

        .field-file-upload i {
            font-size: 28px;
            color: var(--gold);
            margin-bottom: 8px;
        }

        .field-file-upload.has-file i {
            color: var(--success);
        }

        .field-file-upload p {
            font-size: 13px;
            color: var(--gray-400);
        }

        .field-file-upload input[type="file"] {
            display: none;
        }

        .field-file-info {
            display: none;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 10px 12px;
            background: rgba(0, 200, 81, 0.1);
            border-radius: 8px;
        }

        .field-file-info.active {
            display: flex;
        }

        .field-file-info .file-name {
            flex: 1;
            font-size: 13px;
            color: var(--success);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .field-file-info .remove-btn {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            padding: 4px;
            font-size: 14px;
        }

        .field-text-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 14px 16px;
            color: var(--white);
            font-size: 15px;
            transition: all 0.2s ease;
        }

        .field-text-input:focus {
            outline: none;
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.05);
        }

        .field-text-input::placeholder {
            color: var(--gray-600);
        }

        /* SNS ÌîåÎû´Ìèº ÏÑ†ÌÉù */
        .sns-platform-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 12px;
        }

        .sns-platform-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 8px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: transparent;
            color: var(--gray-400);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
        }

        .sns-platform-btn:hover {
            border-color: rgba(255, 215, 0, 0.3);
            color: var(--white);
        }

        .sns-platform-btn.selected {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
            color: var(--white);
        }

        .sns-platform-btn i {
            font-size: 20px;
        }

        .sns-platform-btn.selected i.fa-instagram { color: #E1306C; }
        .sns-platform-btn.selected i.fa-youtube { color: #FF0000; }
        .sns-platform-btn.selected i.fa-tiktok { color: #00F2EA; }
        .sns-platform-btn.selected i.fa-globe { color: var(--gold); }

        .sns-account-input-wrapper {
            display: none;
        }

        .sns-account-input-wrapper.active {
            display: block;
        }

        /* Ï∂îÏ≤ú ÏÑπÏÖò (Ìò∏Ïä§Ìä∏ Ï∂îÏ≤ú Ï†ÑÏö©) */
        .referral-section {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 24px;
            display: none;
        }

        .referral-section.active {
            display: block;
        }

        .referral-section h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .referral-section h2 i {
            color: var(--gold);
        }

        .referral-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 24px;
        }

        .referral-tab {
            flex: 1;
            padding: 14px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .referral-tab:hover {
            border-color: rgba(255, 215, 0, 0.3);
        }

        .referral-tab.active {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
            color: var(--gold);
        }

        .referral-content {
            display: none;
        }

        .referral-content.active {
            display: block;
        }

        .coupon-input-group {
            display: flex;
            gap: 10px;
        }

        .coupon-input-group input {
            flex: 1;
        }

        .btn-verify-coupon {
            background: var(--gold);
            border: none;
            border-radius: 12px;
            padding: 14px 20px;
            font-size: 14px;
            font-weight: 600;
            color: var(--bg-dark);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .btn-verify-coupon:hover {
            background: var(--gold-light);
        }

        .coupon-status {
            margin-top: 12px;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 14px;
            display: none;
        }

        .coupon-status.success {
            display: block;
            background: rgba(57, 255, 20, 0.1);
            border: 1px solid rgba(57, 255, 20, 0.3);
            color: var(--neon-green);
        }

        .coupon-status.error {
            display: block;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            color: var(--error);
        }

        /* Contact Info Section */
        .contact-section {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 24px;
        }

        .contact-section h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .contact-section h2 i {
            color: var(--gold);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            color: var(--gray-400);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 14px 16px;
            font-size: 16px;
            color: var(--white);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.05);
        }

        .form-input::placeholder {
            color: var(--gray-600);
        }

        .form-input textarea {
            resize: vertical;
            min-height: 80px;
        }

        textarea.form-input {
            resize: vertical;
            min-height: 80px;
        }

        .form-divider {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: 20px 0;
            color: var(--gray-500);
            font-size: 14px;
        }

        .form-divider::before,
        .form-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        /* Privacy Checkbox */
        .privacy-check {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            cursor: pointer;
        }

        .privacy-check input {
            display: none;
        }

        .custom-checkbox {
            width: 22px;
            height: 22px;
            min-width: 22px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            margin-top: 2px;
        }

        .privacy-check input:checked + .custom-checkbox {
            background: var(--gold);
            border-color: var(--gold);
        }

        .privacy-check input:checked + .custom-checkbox::after {
            content: '‚úì';
            color: var(--bg-dark);
            font-size: 14px;
            font-weight: bold;
        }

        .privacy-text {
            font-size: 14px;
            color: var(--gray-400);
            line-height: 1.5;
        }

        .privacy-text a {
            color: var(--gold);
            text-decoration: underline;
        }

        /* Warning Notice */
        .warning-notice {
            background: rgba(255, 167, 38, 0.1);
            border: 1px solid rgba(255, 167, 38, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
            display: flex;
            gap: 12px;
        }

        .warning-notice i {
            color: var(--warning);
            font-size: 20px;
        }

        .warning-notice p {
            color: var(--warning);
            font-size: 14px;
            line-height: 1.5;
        }

        /* Info Notice (for onsite) */
        .info-notice {
            background: rgba(57, 255, 20, 0.1);
            border: 1px solid rgba(57, 255, 20, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
            display: none;
        }

        .info-notice.active {
            display: flex;
            gap: 12px;
        }

        .info-notice i {
            color: var(--neon-green);
            font-size: 20px;
        }

        .info-notice p {
            color: var(--neon-green);
            font-size: 14px;
            line-height: 1.5;
        }

        /* Error message */
        .error-message {
            display: none;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            border-radius: 12px;
            padding: 14px 16px;
            margin-bottom: 20px;
            color: var(--error);
            font-size: 14px;
        }

        /* Submit Section */
        .submit-section {
            padding: 20px 0 40px;
        }

        .btn-submit {
            width: 100%;
            background: linear-gradient(135deg, var(--gold), var(--gold-light));
            border: none;
            border-radius: 16px;
            padding: 18px 32px;
            font-size: 18px;
            font-weight: 700;
            color: var(--bg-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        }

        .btn-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-back {
            width: 100%;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 500;
            color: var(--gray-400);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 12px;
        }

        .btn-back:hover {
            border-color: var(--white);
            color: var(--white);
        }

        /* Loading */
        .loading-spinner {
            display: none;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-top-color: var(--bg-dark);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 480px) {
            .container {
                padding: 16px;
            }

            .verification-header {
                padding: 30px 16px;
            }

            .verification-header h1 {
                font-size: 24px;
            }

            .upload-section,
            .contact-section,
            .auth-method-section,
            .referral-section {
                padding: 24px 20px;
            }

            .file-upload-area {
                padding: 30px 16px;
            }

            .file-upload-area i {
                font-size: 36px;
            }

            .coupon-input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="verification-header">
            <h1>üìé Ïù∏ÎπÑÌÖåÏù¥ÏÖò Ìå®Ïä§ Ïã†Ï≤≠</h1>
            <p>ÏûêÍ≤© Ïù∏Ï¶ù Î∞©Î≤ïÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</p>
        </div>

        <!-- Selected Qualifications -->
        <div class="selected-qualification">
            <h3>ÏÑ†ÌÉùÌïú ÏûêÍ≤© ÏöîÍ±¥</h3>
            <div id="qualificationBadges" class="qualification-badges">
                <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê® -->
            </div>
            <!-- ÏôÄÏù∏ Ïù∏ÏÑºÌã∞Î∏å Î∞∞ÎÑà -->
            <div class="wine-bonus-banner" id="wineBonusBanner" style="display: none;">
                <i class="fas fa-wine-bottle"></i>
                <span>üéâ 2Í∞ú ÏòÅÏó≠ Ïù¥ÏÉÅ ÏÑ†ÌÉù! <strong>ÏôÄÏù∏ 1Î≥ë ÏÑ†Î¨º</strong></span>
            </div>
        </div>

        <!-- Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ù ÏÑπÏÖò (ÎèôÏ†Å ÏÉùÏÑ±) -->
        <div class="qualification-sections-container" id="qualificationSectionsContainer">
            <!-- ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏Î°ú ÎèôÏ†Å ÏÉùÏÑ± -->
        </div>

        <!-- Ï∂îÏ≤ú ÏÑπÏÖò (Ïø†Ìè∞ ÏûÖÎ†• Ï†ÑÏö©) -->
        <div class="referral-section" id="referralSection">
            <h2><i class="fas fa-ticket-alt"></i> Ï∂îÏ≤ú ÏΩîÎìú ÏûÖÎ†•</h2>
            
            <!-- Ïø†Ìè∞ Î≤àÌò∏ ÏûÖÎ†• -->
            <div class="referral-content active" id="couponContent">
                <div class="form-group">
                    <label>Ï∂îÏ≤ú ÏΩîÎìú</label>
                    <div class="coupon-input-group">
                        <input type="text" id="couponInput" class="form-input" placeholder="Ï∂îÏ≤ú ÏΩîÎìúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" maxlength="20">
                        <button type="button" class="btn-verify-coupon" id="verifyCouponBtn">ÌôïÏù∏</button>
                    </div>
                    <div class="coupon-status" id="couponStatus"></div>
                </div>
            </div>
        </div>

        <!-- Contact Section -->
        <div class="contact-section">
            <h2><i class="fas fa-phone-alt"></i> Ïó∞ÎùΩÏ≤ò Ï†ïÎ≥¥</h2>
            
            <div class="form-group">
                <label for="phoneInput">Ï†ÑÌôîÎ≤àÌò∏ <span style="color: var(--gold); font-size: 12px;">* ÌîÑÎ¶Ω ÏòàÏïΩ Ïãú ÎèôÏùºÌïú Î≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî</span></label>
                <input type="tel" id="phoneInput" class="form-input" placeholder="010-0000-0000" maxlength="13">
            </div>

            <div class="form-group">
                <label class="privacy-check">
                    <input type="checkbox" id="privacyCheck">
                    <span class="custom-checkbox"></span>
                    <span class="privacy-text">
                        <a href="terms.html" target="_blank">Í∞úÏù∏Ï†ïÎ≥¥ ÏàòÏßë Î∞è Ïù¥Ïö©</a>Ïóê ÎèôÏùòÌï©ÎãàÎã§ (ÌïÑÏàò)
                    </span>
                </label>
            </div>
        </div>

        <!-- Warning Notice (ÏóÖÎ°úÎìú ÏÑ†ÌÉù Ïãú) -->
        <div class="warning-notice" id="warningNotice">
            <i class="fas fa-exclamation-triangle"></i>
            <p>Ïù∏Ï¶ù ÏûêÎ£å ÎØ∏Ìù° ÎòêÎäî ÌóàÏúÑÏã†Ï≤≠ Ïãú Ï∞∏Í∞ÄÎπÑ ÌôòÍ∏âÏù¥ Î∂àÍ∞ÄÌï©ÎãàÎã§.</p>
        </div>

        <!-- Info Notice (ÌòÑÏû• Ïù∏Ï¶ù ÏÑ†ÌÉù Ïãú) -->
        <div class="info-notice" id="infoNotice">
            <i class="fas fa-info-circle"></i>
            <p>ÌååÌã∞ ÎãπÏùº Ïã†Î∂ÑÏ¶ù, Î™ÖÌï® Îì± Ï¶ùÎπôÏÑúÎ•òÎ•º ÏßÄÏ∞∏Ìï¥Ï£ºÏÑ∏Ïöî. ÌòÑÏû•ÏóêÏÑú Ïù∏Ï¶ùÏù¥ ÌôïÏù∏ÎêòÎ©¥ ÌôòÍ∏âÎê©ÎãàÎã§.</p>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage"></div>

        <!-- Submit Section -->
        <div class="submit-section">
            <button type="button" class="btn-submit" id="submitBtn" disabled>
                <span class="loading-spinner" id="loadingSpinner"></span>
                <span id="submitText">Ïã†Ï≤≠ ÏôÑÎ£åÌïòÍ∏∞</span>
                <i class="fas fa-arrow-right" id="submitIcon"></i>
            </button>
            <button type="button" class="btn-back" id="backBtn">
                <i class="fas fa-arrow-left"></i> Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄÎ°ú
            </button>
        </div>
    </div>

    <script>
        // ========================================
        // Constants
        // ========================================
        // Supabase ÏÑ§Ï†ï (Í≥µÍ∞ú ÌÇ§ - Ïã†Ï≤≠/Ï°∞ÌöåÎßå Í∞ÄÎä•)
        const SUPABASE_URL = 'https://bqpxdxsgxoapguknxwul.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxcHhkeHNneG9hcGd1a254d3VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1MjUyNDAsImV4cCI6MjA4MzEwMTI0MH0.v_r3wIIIe024k-H-9dyHH-LJj73kP9iU_eYgHZX7CGA';
        const API_BASE = `${SUPABASE_URL}/rest/v1`;
        
        const SUPABASE_HEADERS = {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
            'Content-Type': 'application/json',
            'Prefer': 'return=representation'
        };
        // ÌååÏùº ÏóÖÎ°úÎìúÏôÄ Î∞±ÏóÖ Î™®Îëê Í∞ôÏùÄ GAS ÏÇ¨Ïö©
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbzW9ts1S4krUi1FKW9mYCGbksIHv1MaqMlYNRa07dPy2887DLjOfcbmjZAsrARXj3X-/exec';
        const FILE_UPLOAD_GAS_URL = GAS_URL;
        const BACKUP_GAS_URL = GAS_URL;
        // Ïø†Ìè∞ Í≤ÄÏ¶ùÏö© (ÎÇòÏ§ëÏóê Î∞∞Ìè¨ ÌõÑ URL ÏóÖÎç∞Ïù¥Ìä∏ ÌïÑÏöî)

        // Ïø†Ìè∞ Í≤ÄÏ¶ùÏùÄ ÏÑúÎ≤Ñ(GAS)ÏóêÏÑú ÏàòÌñâ

        // Qualification data mapping - Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ùÎ∞©Î≤ï ÏÑ†ÌÉù + ÌïÑÎìú Ï†ïÏùò
        const qualificationData = {
            'ÏßÅÏóÖ': {
                icon: 'fa-briefcase',
                label: 'Ï†ÑÎ¨∏ÏßÅ/ÎåÄÍ∏∞ÏóÖ/Í≥µÍ∏∞ÏóÖ/Í≥µÎ¨¥Ïõê',
                description: 'ÎåÄÍ∏∞ÏóÖ, Ï†ÑÎ¨∏ÏßÅ, Í≥µÍ∏∞ÏóÖ, Í≥µÎ¨¥Ïõê Ïû¨ÏßÅÏûê',
                onsiteDocs: 'Î™ÖÌï® ÎòêÎäî ÏÇ¨ÏõêÏ¶ù',
                defaultAuth: 'upload',
                fields: [
                    { id: 'job_cert', type: 'file', label: 'Î™ÖÌï®/ÏÇ¨ÏõêÏ¶ù/Ïû¨ÏßÅÏ¶ùÎ™ÖÏÑú', required: false, accept: 'image/*,application/pdf', hint: 'Î™ÖÌï®, ÏÇ¨ÏõêÏ¶ù, ÎòêÎäî Ïû¨ÏßÅÏ¶ùÎ™ÖÏÑú Ïù¥ÎØ∏ÏßÄ' }
                ]
            },
            'ÌïôÎ†•': {
                icon: 'fa-graduation-cap',
                label: 'SKY Î∞è Ìï¥Ïô∏ÎåÄÌïô Ï°∏ÏóÖÏûê',
                description: 'ÏÑúÏö∏ÎåÄ, Ïó∞ÏÑ∏ÎåÄ, Í≥†Î†§ÎåÄ ÎòêÎäî Ìï¥Ïô∏ Ïú†Î™ÖÎåÄÌïô',
                onsiteDocs: 'ÌïôÏÉùÏ¶ù ÎòêÎäî Ï°∏ÏóÖÏ¶ùÎ™ÖÏÑú',
                defaultAuth: 'upload',
                fields: [
                    { id: 'edu_cert', type: 'file', label: 'Ï°∏ÏóÖÏ¶ùÎ™ÖÏÑú/ÌïôÏÉùÏ¶ù', required: false, accept: 'image/*,application/pdf', hint: 'Ï°∏ÏóÖÏ¶ùÎ™ÖÏÑú ÎòêÎäî ÌïôÏÉùÏ¶ù Ïù¥ÎØ∏ÏßÄ' }
                ]
            },
            'Ïó∞Î¥âÏûêÏÇ∞': {
                icon: 'fa-chart-line',
                label: 'Ïó∞Î¥â 8Ï≤úÎßåÏõê / ÏûêÏÇ∞ 5ÏñµÏõê Ïù¥ÏÉÅ',
                description: 'Í≥†ÏÜåÎìùÏûê ÎòêÎäî Í≥†ÏûêÏÇ∞Í∞Ä',
                onsiteDocs: 'ÏÜåÎìù/ÏûêÏÇ∞ Ï¶ùÎπô ÏÑúÎ•ò',
                sensitive: true,
                defaultAuth: 'onsite',  // ÎØºÍ∞êÏ†ïÎ≥¥Îäî ÌòÑÏû• Ïù∏Ï¶ù Í∏∞Î≥∏
                fields: [
                    { id: 'asset_cert', type: 'file', label: 'ÏÜåÎìù/ÏûêÏÇ∞ Ï¶ùÎπô ÏÑúÎ•ò', required: false, accept: 'image/*,application/pdf', hint: 'Ïó∞Î¥â ÎòêÎäî ÏûêÏÇ∞ Ï¶ùÎπô ÏÑúÎ•ò' }
                ]
            },
            'SNS': {
                icon: 'fa-hashtag',
                label: 'ÏÜåÏÖúÎØ∏ÎîîÏñ¥ ÌåîÎ°úÏõå 5Ï≤úÎ™Ö Ïù¥ÏÉÅ',
                description: 'Ïù∏Ïä§ÌÉÄÍ∑∏Îû®, Ïú†ÌäúÎ∏å, Ìã±ÌÜ° Îì±',
                onsiteDocs: 'SNS Í≥ÑÏ†ï ÌôîÎ©¥',
                defaultAuth: 'upload',
                hasPlatformSelect: true,  // ÌîåÎû´Ìèº ÏÑ†ÌÉù ÌïÑÏöî
                fields: [
                    { id: 'sns_platform', type: 'platform', label: 'SNS ÌîåÎû´Ìèº', required: true },
                    { id: 'sns_account', type: 'sns_input', label: 'Í≥ÑÏ†ï Ï†ïÎ≥¥', required: true, hint: 'ÌîåÎû´Ìèº ÏÑ†ÌÉù ÌõÑ ÏûÖÎ†•' },
                    { id: 'sns_screenshot', type: 'file', label: 'ÌåîÎ°úÏõå Ïä§ÌÅ¨Î¶∞ÏÉ∑', required: false, accept: 'image/*', hint: 'ÌåîÎ°úÏõå ÏàòÍ∞Ä Î≥¥Ïù¥Îäî Ïä§ÌÅ¨Î¶∞ÏÉ∑ (ÏÑ†ÌÉù)' }
                ]
            },
            'Ïö¥Îèô': {
                icon: 'fa-running',
                label: 'ÌÅ¨Î°úÏä§Ìïè/ÎßàÎùºÌÜ§ ÏôÑÏ£º ÎòêÎäî Ï≤¥ÏßÄÎ∞©',
                description: 'Ïö¥Îèô ÏÑ±Í≥º Î≥¥Ïú†Ïûê',
                onsiteDocs: 'ÏôÑÏ£º Î©îÎã¨ ÎòêÎäî Ïù∏Î∞îÎîî Í≤∞Í≥ºÏßÄ',
                defaultAuth: 'upload',
                fields: [
                    { id: 'fitness_cert', type: 'file', label: 'ÏôÑÏ£º Ïù∏Ï¶ùÏÑú/Ïù∏Î∞îÎîî', required: false, accept: 'image/*,application/pdf', hint: 'ÏôÑÏ£º Ïù∏Ï¶ùÏÑú ÎòêÎäî Ïù∏Î∞îÎîî Í≤∞Í≥ºÏßÄ' }
                ]
            },
            'Ïô∏Î™®': {
                icon: 'fa-gem',
                label: 'ÏäπÎ¨¥Ïõê/ÏïÑÎÇòÏö¥ÏÑú/ÎØ∏Ïù∏ÎåÄÌöå Îì±',
                description: 'Ïô∏Î™® ÏûêÏã†ÏûàÎäî Î∂Ñ',
                onsiteDocs: 'Ïã†Î∂ÑÏ¶ù (ÌòÑÏû• ÌôïÏù∏)',
                defaultAuth: 'upload',
                fields: [
                    { id: 'photo_1', type: 'file', label: 'Î≥∏Ïù∏ ÏÇ¨ÏßÑ 1', required: false, accept: 'image/*', hint: 'ÏñºÍµ¥Ïù¥ Ïûò Î≥¥Ïù¥Îäî ÏÇ¨ÏßÑ' },
                    { id: 'photo_2', type: 'file', label: 'Î≥∏Ïù∏ ÏÇ¨ÏßÑ 2', required: false, accept: 'image/*', hint: 'Ï†ÑÏã† ÎòêÎäî Îã§Î•∏ Í∞ÅÎèÑ ÏÇ¨ÏßÑ' }
                ]
            },
            'ÎìùÌëú3Ìëú': {
                icon: 'fa-trophy',
                label: 'Í∏∞Ï°¥ ÌååÌã∞ ÎèôÏãú ÎìùÌëú 3Ìëú Ïù¥ÏÉÅ',
                description: 'Ïù¥Ï†Ñ ÌååÌã∞ÏóêÏÑú Ïù∏Í∏∞ Í≤ÄÏ¶ù',
                onsiteDocs: 'Ìò∏Ïä§Ìä∏ÏóêÍ≤å ÌôïÏù∏',
                defaultAuth: 'upload',
                fields: [
                    { id: 'party_name', type: 'text', label: 'Ï∞∏ÏÑùÌñàÎçò ÌååÌã∞ Ïù¥Î¶Ñ', required: true, placeholder: 'Ïòà: 2024ÎÖÑ 12Ïõî ÌÅ¨Î¶¨Ïä§ÎßàÏä§ ÌååÌã∞', hint: 'ÎìùÌëúÎ•º Î∞õÏùÄ ÌååÌã∞ Ïù¥Î¶Ñ' },
                    { id: 'vote_screenshot', type: 'file', label: 'ÎìùÌëú Ïù∏Ï¶ù Ïä§ÌÅ¨Î¶∞ÏÉ∑', required: false, accept: 'image/*', hint: 'ÎìùÌëú ÌôîÎ©¥ Ï∫°Ï≤ò (ÏûàÎã§Î©¥)' }
                ]
            },
            'Ï∂îÏ≤ú': {
                icon: 'fa-ticket-alt',
                label: 'Ï∂îÏ≤ú ÏΩîÎìú Î≥¥Ïú†',
                description: 'Ìò∏Ïä§Ìä∏ ÎòêÎäî ÏßÄÏù∏ Ï∂îÏ≤ú',
                onsiteDocs: '',
                defaultAuth: 'coupon',
                fields: []
            }
        };

        // Ìï≠Î™©Î≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• (Ïù∏Ï¶ùÎ∞©Î≤ï + ÌïÑÎìúÍ∞í)
        let qualificationFields = {};

        // State
        let selectedQualifications = [];
        let selectedGroups = [];
        let wineBonus = false;
        let couponVerified = false;

        // ========================================
        // Initialize
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            // Get qualifications from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const qualificationsParam = urlParams.get('qualifications') || '';
            const groupsParam = urlParams.get('groups') || '';
            wineBonus = urlParams.get('wineBonus') === 'true';

            selectedQualifications = qualificationsParam ? qualificationsParam.split(',') : [];
            selectedGroups = groupsParam ? groupsParam.split(',') : [];

            // Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            if (selectedQualifications.length === 0) {
                alert('ÏûêÍ≤© ÏöîÍ±¥ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                window.location.href = 'index.html#apply';
                return;
            }

            // Î™®Îì† ÏÑ†ÌÉùÎêú ÏûêÍ≤©Ïù¥ Ïú†Ìö®ÌïúÏßÄ ÌôïÏù∏
            const invalidQuals = selectedQualifications.filter(q => !qualificationData[q]);
            if (invalidQuals.length > 0) {
                alert('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ ÏûêÍ≤© ÏöîÍ±¥Ïù¥ ÏûàÏäµÎãàÎã§.');
                window.location.href = 'index.html#apply';
                return;
            }

            // Ìï≠Î™©Î≥Ñ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
            selectedQualifications.forEach(qual => {
                const data = qualificationData[qual];
                qualificationFields[qual] = {
                    authMethod: data.defaultAuth || 'upload',
                    fields: {}
                };
            });

            // Display selected qualifications
            displayQualifications();

            // Setup event listeners
            setupEventListeners();

            // Check for stored contact info
            loadStoredContactInfo();

            // Ï∂îÏ≤ú Ìï≠Î™©Îßå ÏÑ†ÌÉùÌïú Í≤ΩÏö∞ ÌäπÎ≥Ñ Ï≤òÎ¶¨
            if (selectedQualifications.length === 1 && selectedQualifications[0] === 'Ï∂îÏ≤ú') {
                document.getElementById('referralSection').classList.add('active');
                document.getElementById('warningNotice').style.display = 'none';
            }
        });

        // ========================================
        // Display Qualifications (Î≥µÏàò)
        // ========================================
        function displayQualifications() {
            const badgesContainer = document.getElementById('qualificationBadges');
            
            // Í∞Å ÏûêÍ≤©Ïóê ÎåÄÌï¥ Î∞∞ÏßÄ ÏÉùÏÑ±
            badgesContainer.innerHTML = selectedQualifications.map(qual => {
                const data = qualificationData[qual];
                return `
                    <div class="qualification-badge">
                        <i class="fas ${data.icon}"></i>
                        <span>${qual}</span>
                    </div>
                `;
            }).join('');

            // ÏôÄÏù∏ Î≥¥ÎÑàÏä§ Î∞∞ÎÑà ÌëúÏãú
            if (wineBonus) {
                document.getElementById('wineBonusBanner').style.display = 'flex';
            }

            // Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ù ÏÑπÏÖò ÏÉùÏÑ±
            renderQualificationSections();
        }

        // ========================================
        // Render Qualification Sections (Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ùÎ∞©Î≤ï + ÌïÑÎìú)
        // ========================================
        function renderQualificationSections() {
            const container = document.getElementById('qualificationSectionsContainer');
            container.innerHTML = '';

            selectedQualifications.forEach(qual => {
                const data = qualificationData[qual];
                if (qual === 'Ï∂îÏ≤ú') return; // Ï∂îÏ≤úÏùÄ Î≥ÑÎèÑ ÏÑπÏÖò

                const sensitiveClass = data.sensitive ? 'sensitive' : '';
                const sensitiveBadge = data.sensitive ? '<span class="sensitive-badge">‚ö†Ô∏è ÎØºÍ∞êÏ†ïÎ≥¥</span>' : '';
                const defaultAuth = qualificationFields[qual]?.authMethod || data.defaultAuth || 'upload';

                const sectionHtml = `
                    <div class="qualification-section ${sensitiveClass}" data-qual="${qual}">
                        <div class="qual-header">
                            <i class="fas ${data.icon}"></i>
                            <div class="qual-header-text">
                                <h4>${qual}</h4>
                                <p>${data.label}</p>
                            </div>
                            ${sensitiveBadge}
                        </div>
                        
                        <!-- Ïù∏Ï¶ùÎ∞©Î≤ï ÏÑ†ÌÉù -->
                        <div class="qual-auth-method">
                            <label class="qual-auth-option ${defaultAuth === 'upload' ? 'selected' : ''}" data-qual="${qual}" data-method="upload">
                                <input type="radio" name="auth_${qual}" value="upload" ${defaultAuth === 'upload' ? 'checked' : ''}>
                                <span class="qual-auth-radio"></span>
                                <span class="qual-auth-label"><i class="fas fa-cloud-upload-alt"></i> ÏßÄÍ∏à Ï≤®Î∂Ä</span>
                            </label>
                            <label class="qual-auth-option ${defaultAuth === 'onsite' ? 'selected' : ''}" data-qual="${qual}" data-method="onsite">
                                <input type="radio" name="auth_${qual}" value="onsite" ${defaultAuth === 'onsite' ? 'checked' : ''}>
                                <span class="qual-auth-radio"></span>
                                <span class="qual-auth-label"><i class="fas fa-building"></i> ÌòÑÏû• Ïù∏Ï¶ù</span>
                            </label>
                        </div>
                        
                        <!-- ÌòÑÏû• Ïù∏Ï¶ù ÏïàÎÇ¥ -->
                        <div class="onsite-info ${defaultAuth === 'onsite' ? 'active' : ''}" id="onsite_${qual}">
                            <i class="fas fa-info-circle"></i>
                            ÌååÌã∞ ÎãπÏùº <strong>${data.onsiteDocs}</strong>ÏùÑ(Î•º) ÏßÄÏ∞∏Ìï¥Ï£ºÏÑ∏Ïöî.
                        </div>
                        
                        <!-- ÏóÖÎ°úÎìú ÌïÑÎìú ÏòÅÏó≠ -->
                        <div class="qual-upload-fields ${defaultAuth === 'upload' ? 'active' : ''}" id="fields_${qual}">
                            ${renderQualificationFields(qual, data)}
                        </div>
                    </div>
                `;
                container.innerHTML += sectionHtml;
            });

            // Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
            bindSectionEvents();
        }

        function renderQualificationFields(qual, data) {
            if (!data.fields || data.fields.length === 0) return '';

            return data.fields.map(field => {
                const fieldKey = `${qual}_${field.id}`;
                const requiredMark = field.required ? '<span class="required-mark">*ÌïÑÏàò</span>' : '';

                // SNS ÌîåÎû´Ìèº ÏÑ†ÌÉù
                if (field.type === 'platform') {
                    return `
                        <div class="field-item" data-field-key="${fieldKey}">
                            <div class="field-label">${field.label} ${requiredMark}</div>
                            <div class="sns-platform-buttons" data-qual="${qual}">
                                <button type="button" class="sns-platform-btn" data-platform="instagram">
                                    <i class="fab fa-instagram"></i>
                                    <span>Ïù∏Ïä§ÌÉÄÍ∑∏Îû®</span>
                                </button>
                                <button type="button" class="sns-platform-btn" data-platform="youtube">
                                    <i class="fab fa-youtube"></i>
                                    <span>Ïú†ÌäúÎ∏å</span>
                                </button>
                                <button type="button" class="sns-platform-btn" data-platform="tiktok">
                                    <i class="fab fa-tiktok"></i>
                                    <span>Ìã±ÌÜ°</span>
                                </button>
                                <button type="button" class="sns-platform-btn" data-platform="other">
                                    <i class="fas fa-globe"></i>
                                    <span>Í∏∞ÌÉÄ</span>
                                </button>
                            </div>
                        </div>
                    `;
                }

                // SNS Í≥ÑÏ†ï ÏûÖÎ†• (ÌîåÎû´ÌèºÏóê Îî∞Îùº Îã§Î¶Ñ)
                if (field.type === 'sns_input') {
                    return `
                        <div class="field-item sns-account-input-wrapper" data-field-key="${fieldKey}" id="sns_input_wrapper_${qual}">
                            <div class="field-label" id="sns_label_${qual}">${field.label} ${requiredMark}</div>
                            <input type="text" class="field-text-input" id="sns_account_${qual}" 
                                   placeholder="ÌîåÎû´ÌèºÏùÑ Î®ºÏ†Ä ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî" 
                                   data-field-key="${fieldKey}" disabled>
                            <div class="field-hint" id="sns_hint_${qual}">${field.hint || ''}</div>
                        </div>
                    `;
                }

                // ÌååÏùº ÏóÖÎ°úÎìú
                if (field.type === 'file') {
                    return `
                        <div class="field-item" data-field-key="${fieldKey}">
                            <div class="field-label">${field.label} ${requiredMark}</div>
                            <div class="field-file-upload" data-field-key="${fieldKey}">
                                <input type="file" id="file_${fieldKey}" accept="${field.accept || 'image/*,application/pdf'}" style="display:none;">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>ÌÅ¥Î¶≠ÌïòÏó¨ ÌååÏùº ÏÑ†ÌÉù</p>
                            </div>
                            <div class="field-file-info" id="info_${fieldKey}">
                                <i class="fas fa-file"></i>
                                <span class="file-name" id="name_${fieldKey}"></span>
                                <button type="button" class="remove-btn" data-field-key="${fieldKey}"><i class="fas fa-times"></i></button>
                            </div>
                            <div class="field-hint">${field.hint || ''}</div>
                        </div>
                    `;
                }

                // ÌÖçÏä§Ìä∏ ÏûÖÎ†•
                if (field.type === 'text') {
                    return `
                        <div class="field-item" data-field-key="${fieldKey}">
                            <div class="field-label">${field.label} ${requiredMark}</div>
                            <input type="text" class="field-text-input" id="text_${fieldKey}" 
                                   placeholder="${field.placeholder || ''}" 
                                   data-field-key="${fieldKey}">
                            <div class="field-hint">${field.hint || ''}</div>
                        </div>
                    `;
                }

                return '';
            }).join('');
        }

        function bindSectionEvents() {
            // Ïù∏Ï¶ùÎ∞©Î≤ï ÏÑ†ÌÉù
            document.querySelectorAll('.qual-auth-option').forEach(option => {
                option.addEventListener('click', function() {
                    const qual = this.dataset.qual;
                    const method = this.dataset.method;
                    
                    // ÎùºÎîîÏò§ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                    document.querySelectorAll(`.qual-auth-option[data-qual="${qual}"]`).forEach(opt => {
                        opt.classList.remove('selected');
                        opt.querySelector('input').checked = false;
                    });
                    this.classList.add('selected');
                    this.querySelector('input').checked = true;
                    
                    // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    qualificationFields[qual].authMethod = method;
                    
                    // UI ÌÜ†Í∏Ä
                    const onsiteInfo = document.getElementById(`onsite_${qual}`);
                    const fieldsArea = document.getElementById(`fields_${qual}`);
                    
                    if (method === 'onsite') {
                        onsiteInfo.classList.add('active');
                        fieldsArea.classList.remove('active');
                    } else {
                        onsiteInfo.classList.remove('active');
                        fieldsArea.classList.add('active');
                    }
                    
                    validateForm();
                });
            });

            // SNS ÌîåÎû´Ìèº ÏÑ†ÌÉù
            document.querySelectorAll('.sns-platform-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const qual = this.closest('.sns-platform-buttons').dataset.qual;
                    const platform = this.dataset.platform;
                    
                    // ÏÑ†ÌÉù ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                    this.closest('.sns-platform-buttons').querySelectorAll('.sns-platform-btn').forEach(b => {
                        b.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    
                    // Í≥ÑÏ†ï ÏûÖÎ†• ÌïÑÎìú ÌôúÏÑ±Ìôî Î∞è ÏÑ§Ï†ï
                    const wrapper = document.getElementById(`sns_input_wrapper_${qual}`);
                    const input = document.getElementById(`sns_account_${qual}`);
                    const label = document.getElementById(`sns_label_${qual}`);
                    const hint = document.getElementById(`sns_hint_${qual}`);
                    
                    wrapper.classList.add('active');
                    input.disabled = false;
                    input.value = '';
                    
                    // ÌîåÎû´ÌèºÎ≥Ñ ÏÑ§Ï†ï
                    switch(platform) {
                        case 'instagram':
                            label.innerHTML = '<i class="fab fa-instagram" style="color:#E1306C"></i> Ïù∏Ïä§ÌÉÄÍ∑∏Îû® ÏïÑÏù¥Îîî <span class="required-mark">*ÌïÑÏàò</span>';
                            input.placeholder = '@ ÏóÜÏù¥ ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†• (Ïòà: svvy_official)';
                            hint.textContent = 'ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†•ÌïòÎ©¥ Îê©ÎãàÎã§. ÎßÅÌÅ¨Îäî ÏûêÎèô ÏÉùÏÑ±Îê©ÎãàÎã§.';
                            input.type = 'text';
                            break;
                        case 'youtube':
                            label.innerHTML = '<i class="fab fa-youtube" style="color:#FF0000"></i> Ïú†ÌäúÎ∏å Ï±ÑÎÑê <span class="required-mark">*ÌïÑÏàò</span>';
                            input.placeholder = 'Ï±ÑÎÑê ÎßÅÌÅ¨ (https://youtube.com/...)';
                            hint.textContent = 'Ï±ÑÎÑê ÎßÅÌÅ¨Î•º Î∂ôÏó¨ÎÑ£Ïñ¥Ï£ºÏÑ∏Ïöî.';
                            input.type = 'url';
                            break;
                        case 'tiktok':
                            label.innerHTML = '<i class="fab fa-tiktok" style="color:#00F2EA"></i> Ìã±ÌÜ° ÏïÑÏù¥Îîî <span class="required-mark">*ÌïÑÏàò</span>';
                            input.placeholder = '@ ÏóÜÏù¥ ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†• (Ïòà: svvy_official)';
                            hint.textContent = 'ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†•ÌïòÎ©¥ Îê©ÎãàÎã§. ÎßÅÌÅ¨Îäî ÏûêÎèô ÏÉùÏÑ±Îê©ÎãàÎã§.';
                            input.type = 'text';
                            break;
                        case 'other':
                            label.innerHTML = '<i class="fas fa-globe" style="color:#FFD700"></i> SNS ÎßÅÌÅ¨ <span class="required-mark">*ÌïÑÏàò</span>';
                            input.placeholder = 'https://...';
                            hint.textContent = 'Ï†ÑÏ≤¥ ÎßÅÌÅ¨Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.';
                            input.type = 'url';
                            break;
                    }
                    
                    // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    if (!qualificationFields[qual].fields) qualificationFields[qual].fields = {};
                    qualificationFields[qual].fields.sns_platform = { type: 'text', value: platform };
                    
                    input.focus();
                    validateForm();
                });
            });

            // SNS Í≥ÑÏ†ï ÏûÖÎ†•
            document.querySelectorAll('[id^="sns_account_"]').forEach(input => {
                input.addEventListener('input', function() {
                    const qual = this.id.replace('sns_account_', '');
                    const platform = qualificationFields[qual]?.fields?.sns_platform?.value;
                    let value = this.value.trim().replace(/^@/, '');
                    
                    // ÌîåÎû´ÌèºÎ≥Ñ ÎßÅÌÅ¨ Î≥ÄÌôò
                    let snsLink = value;
                    if (platform === 'instagram' && value && !value.includes('instagram.com')) {
                        snsLink = `https://instagram.com/${value}`;
                    } else if (platform === 'tiktok' && value && !value.includes('tiktok.com')) {
                        snsLink = `https://tiktok.com/@${value}`;
                    }
                    
                    // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    if (!qualificationFields[qual].fields) qualificationFields[qual].fields = {};
                    qualificationFields[qual].fields.sns_account = { type: 'text', value: value, link: snsLink };
                    
                    validateForm();
                });
            });

            // ÌååÏùº ÏóÖÎ°úÎìú ÏòÅÏó≠ ÌÅ¥Î¶≠
            document.querySelectorAll('.field-file-upload').forEach(area => {
                area.addEventListener('click', function() {
                    const fieldKey = this.dataset.fieldKey;
                    document.getElementById(`file_${fieldKey}`).click();
                });

                // ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠
                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });
                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });
                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');
                    const fieldKey = area.dataset.fieldKey;
                    handleFieldFile(fieldKey, e.dataTransfer.files[0]);
                });
            });

            // ÌååÏùº input change
            document.querySelectorAll('.field-file-upload input[type="file"]').forEach(input => {
                input.addEventListener('change', function() {
                    const fieldKey = this.id.replace('file_', '');
                    if (this.files.length > 0) {
                        handleFieldFile(fieldKey, this.files[0]);
                    }
                });
            });

            // ÌååÏùº ÏÇ≠Ï†ú Î≤ÑÌäº
            document.querySelectorAll('.field-file-info .remove-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const fieldKey = this.dataset.fieldKey;
                    removeFieldFile(fieldKey);
                });
            });

            // ÌÖçÏä§Ìä∏ ÏûÖÎ†•
            document.querySelectorAll('.field-text-input:not([id^="sns_account_"])').forEach(input => {
                input.addEventListener('input', function() {
                    const fieldKey = this.dataset.fieldKey;
                    const [qual, ...rest] = fieldKey.split('_');
                    const fieldId = rest.join('_');
                    
                    if (!qualificationFields[qual].fields) qualificationFields[qual].fields = {};
                    qualificationFields[qual].fields[fieldId] = { type: 'text', value: this.value };
                    validateForm();
                });
            });
        }

        function handleFieldFile(fieldKey, file) {
            if (!file) return;

            // ÌååÏùº ÌÅ¨Í∏∞ Ï≤¥ÌÅ¨ (10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('ÌååÏùº ÌÅ¨Í∏∞Îäî 10MB Ïù¥ÌïòÎ°ú Ï†úÌïúÎê©ÎãàÎã§.');
                return;
            }

            const [qual, ...rest] = fieldKey.split('_');
            const fieldId = rest.join('_');

            // qualificationFieldsÏóê Ï†ÄÏû• (ÏÉà Íµ¨Ï°∞)
            if (!qualificationFields[qual]) qualificationFields[qual] = { authMethod: 'upload', fields: {} };
            if (!qualificationFields[qual].fields) qualificationFields[qual].fields = {};
            qualificationFields[qual].fields[fieldId] = { type: 'file', file: file, name: file.name };

            // UI ÏóÖÎç∞Ïù¥Ìä∏
            const uploadArea = document.querySelector(`.field-file-upload[data-field-key="${fieldKey}"]`);
            const fileInfo = document.getElementById(`info_${fieldKey}`);
            const fileName = document.getElementById(`name_${fieldKey}`);

            if (uploadArea) uploadArea.classList.add('has-file');
            if (fileInfo) fileInfo.classList.add('active');
            if (fileName) fileName.textContent = file.name;

            validateForm();
        }

        function removeFieldFile(fieldKey) {
            const [qual, ...rest] = fieldKey.split('_');
            const fieldId = rest.join('_');

            // qualificationFieldsÏóêÏÑú Ï†úÍ±∞
            if (qualificationFields[qual]?.fields?.[fieldId]) {
                delete qualificationFields[qual].fields[fieldId];
            }

            // UI ÏóÖÎç∞Ïù¥Ìä∏
            const uploadArea = document.querySelector(`.field-file-upload[data-field-key="${fieldKey}"]`);
            const fileInfo = document.getElementById(`info_${fieldKey}`);
            const fileInput = document.getElementById(`file_${fieldKey}`);

            if (uploadArea) uploadArea.classList.remove('has-file');
            if (fileInfo) fileInfo.classList.remove('active');
            if (fileInput) fileInput.value = '';

            validateForm();
        }

        // ========================================
        // Event Listeners
        // ========================================
        function setupEventListeners() {
            // Auth method selection
            document.querySelectorAll('.auth-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectAuthMethod(this.dataset.method);
                });
            });

            // Phone number formatting
            document.getElementById('phoneInput').addEventListener('input', formatPhoneNumber);

            // Privacy checkbox
            document.getElementById('privacyCheck').addEventListener('change', validateForm);

            // Contact inputs
            document.getElementById('phoneInput').addEventListener('input', validateForm);

            // Submit button
            document.getElementById('submitBtn').addEventListener('click', handleSubmit);

            // Back button
            document.getElementById('backBtn').addEventListener('click', () => {
                window.location.href = 'index.html#apply';
            });

            // Ïø†Ìè∞ ÌôïÏù∏ Î≤ÑÌäº
            document.getElementById('verifyCouponBtn').addEventListener('click', verifyCoupon);

            // Ïø†Ìè∞ ÏûÖÎ†• ÏóîÌÑ∞ÌÇ§
            document.getElementById('couponInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') verifyCoupon();
            });
        }

        // ========================================
        // Select Auth Method
        // ========================================
        function selectAuthMethod(method) {
            selectedAuthMethod = method;

            // Update UI
            document.querySelectorAll('.auth-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.method === method) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });

            // Show/hide sections
            const uploadSection = document.getElementById('uploadSection');
            const warningNotice = document.getElementById('warningNotice');
            const infoNotice = document.getElementById('infoNotice');

            if (method === 'upload') {
                uploadSection.classList.add('active');
                warningNotice.style.display = 'flex';
                infoNotice.classList.remove('active');
            } else if (method === 'onsite') {
                uploadSection.classList.remove('active');
                warningNotice.style.display = 'none';
                infoNotice.classList.add('active');
            }

            validateForm();
        }



        // ========================================
        // Verify Coupon (ÏÑúÎ≤Ñ Í≤ÄÏ¶ù)
        // ========================================
        async function verifyCoupon() {
            const couponInput = document.getElementById('couponInput');
            const couponStatus = document.getElementById('couponStatus');
            const coupon = couponInput.value.trim().toUpperCase();

            if (!coupon) {
                couponStatus.className = 'coupon-status error';
                couponStatus.textContent = 'Ïø†Ìè∞ Î≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.';
                couponVerified = false;
                validateForm();
                return;
            }

            // Î°úÎî© ÌëúÏãú
            couponStatus.className = 'coupon-status';
            couponStatus.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ÌôïÏù∏ Ï§ë...';

            try {
                // SupabaseÎ°ú Ïø†Ìè∞ Í≤ÄÏ¶ù
                const response = await fetch(`${API_BASE}/coupons?id=eq.${encodeURIComponent(coupon)}&select=*`, {
                    headers: SUPABASE_HEADERS
                });
                
                if (response.ok) {
                    const result = await response.json();
                    const couponData = result[0];  // SupabaseÎäî Î∞∞Ïó¥ Î∞òÌôò
                    if (couponData && couponData.is_active) {
                        couponStatus.className = 'coupon-status success';
                        couponStatus.innerHTML = '<i class="fas fa-check-circle"></i> Ïú†Ìö®Ìïú Ïø†Ìè∞ÏûÖÎãàÎã§. Ïù∏ÎπÑÌÖåÏù¥ÏÖò Ìå®Ïä§Í∞Ä Ï†ÅÏö©Îê©ÎãàÎã§!';
                        couponVerified = true;
                    } else {
                        couponStatus.className = 'coupon-status error';
                        couponStatus.textContent = 'ÎßåÎ£åÎêú Ïø†Ìè∞ÏûÖÎãàÎã§.';
                        couponVerified = false;
                    }
                } else {
                    couponStatus.className = 'coupon-status error';
                    couponStatus.textContent = 'Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ïø†Ìè∞ Î≤àÌò∏ÏûÖÎãàÎã§.';
                    couponVerified = false;
                }
            } catch (error) {
                console.error('Ïø†Ìè∞ Í≤ÄÏ¶ù Ïò§Î•ò:', error);
                // ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•ò Ïãú Î°úÏª¨ Î∞±ÏóÖ Í≤ÄÏ¶ù
                const backupCoupons = ['WELCOME23', 'VIP2024', 'HOST001', 'SVVY2024'];
                if (backupCoupons.includes(coupon)) {
                    couponStatus.className = 'coupon-status success';
                    couponStatus.innerHTML = '<i class="fas fa-check-circle"></i> Ïú†Ìö®Ìïú Ïø†Ìè∞ÏûÖÎãàÎã§!';
                    couponVerified = true;
                } else {
                    couponStatus.className = 'coupon-status error';
                    couponStatus.textContent = 'Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ïø†Ìè∞ Î≤àÌò∏ÏûÖÎãàÎã§.';
                    couponVerified = false;
                }
            }

            validateForm();
        }

        // ========================================
        // SNS Platform Change Handler
        // ========================================
        let selectedPlatform = '';
        
        function handlePlatformChange(e) {
            selectedPlatform = e.target.value;
            const wrapper = document.getElementById('snsInputWrapper');
            const label = document.getElementById('snsInputLabel');
            const input = document.getElementById('snsAccountInput');
            const hint = document.getElementById('snsInputHint');
            const error = document.getElementById('snsError');
            
            wrapper.style.display = 'block';
            error.style.display = 'none';
            input.value = '';
            
            switch(selectedPlatform) {
                case 'instagram':
                    label.innerHTML = '<i class="fab fa-instagram" style="color:#E1306C"></i> Ïù∏Ïä§ÌÉÄÍ∑∏Îû® ÏïÑÏù¥Îîî';
                    input.placeholder = '@ ÏóÜÏù¥ ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†• (Ïòà: svvy_official)';
                    hint.textContent = 'ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†•ÌïòÎ©¥ Îê©ÎãàÎã§. ÎßÅÌÅ¨Îäî ÏûêÎèô ÏÉùÏÑ±Îê©ÎãàÎã§.';
                    input.type = 'text';
                    break;
                case 'youtube':
                    label.innerHTML = '<i class="fab fa-youtube" style="color:#FF0000"></i> Ïú†ÌäúÎ∏å Ï±ÑÎÑê';
                    input.placeholder = 'Ï±ÑÎÑêÎ™Ö ÎòêÎäî Ï±ÑÎÑê ÎßÅÌÅ¨';
                    hint.textContent = 'Ï±ÑÎÑêÎ™ÖÎßå ÏûÖÎ†•ÌïòÍ±∞ÎÇò, Ï±ÑÎÑê ÎßÅÌÅ¨Î•º Î∂ôÏó¨ÎÑ£Ïñ¥ÎèÑ Îê©ÎãàÎã§.';
                    input.type = 'text';
                    break;
                case 'tiktok':
                    label.innerHTML = '<i class="fab fa-tiktok" style="color:#00F2EA"></i> Ìã±ÌÜ° ÏïÑÏù¥Îîî';
                    input.placeholder = '@ ÏóÜÏù¥ ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†• (Ïòà: svvy_official)';
                    hint.textContent = 'ÏïÑÏù¥ÎîîÎßå ÏûÖÎ†•ÌïòÎ©¥ Îê©ÎãàÎã§. ÎßÅÌÅ¨Îäî ÏûêÎèô ÏÉùÏÑ±Îê©ÎãàÎã§.';
                    input.type = 'text';
                    break;
                case 'other':
                    label.innerHTML = '<i class="fas fa-globe" style="color:#FFD700"></i> SNS ÎßÅÌÅ¨';
                    input.placeholder = 'https://...';
                    hint.textContent = 'Ï†ÑÏ≤¥ ÎßÅÌÅ¨Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.';
                    input.type = 'url';
                    break;
            }
            
            validateForm();
        }

        // SNS ÏûÖÎ†•Í∞íÏùÑ ÎßÅÌÅ¨Î°ú Î≥ÄÌôò
        function getSnsLink() {
            const input = document.getElementById('snsAccountInput');
            if (!input) return '';
            
            const value = input.value.trim().replace(/^@/, ''); // @ Ï†úÍ±∞
            
            if (!value) return '';
            
            switch(selectedPlatform) {
                case 'instagram':
                    // Ïù¥ÎØ∏ ÎßÅÌÅ¨Î©¥ Í∑∏ÎåÄÎ°ú, ÏïÑÎãàÎ©¥ ÎßÅÌÅ¨ ÏÉùÏÑ±
                    if (value.includes('instagram.com')) return value;
                    return 'instagram.com/' + value;
                case 'youtube':
                    // Ïù¥ÎØ∏ ÎßÅÌÅ¨Î©¥ Í∑∏ÎåÄÎ°ú, ÏïÑÎãàÎ©¥ Ï±ÑÎÑêÎ™ÖÏúºÎ°ú Ï†ÄÏû•
                    if (value.includes('youtube.com') || value.includes('youtu.be')) return value;
                    return 'youtube: ' + value;
                case 'tiktok':
                    if (value.includes('tiktok.com')) return value;
                    return 'tiktok.com/@' + value;
                case 'other':
                    return value;
                default:
                    return value;
            }
        }

        // SNS ÏûÖÎ†• Í≤ÄÏ¶ù
        function validateSnsInput() {
            const input = document.getElementById('snsAccountInput');
            const error = document.getElementById('snsError');
            
            if (!selectedPlatform) {
                error.textContent = 'ÌîåÎû´ÌèºÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.';
                error.style.display = 'block';
                return false;
            }
            
            const value = input.value.trim();
            
            if (!value) {
                error.textContent = 'Í≥ÑÏ†ï Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.';
                error.style.display = 'block';
                return false;
            }
            
            // Í∏∞ÌÉÄÏù∏ Í≤ΩÏö∞ ÎßÅÌÅ¨ ÌòïÏãù Í≤ÄÏ¶ù
            if (selectedPlatform === 'other') {
                if (!value.startsWith('http://') && !value.startsWith('https://')) {
                    error.textContent = 'ÎßÅÌÅ¨ ÌòïÏãùÏúºÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. (https://...)';
                    error.style.display = 'block';
                    return false;
                }
            }
            
            error.style.display = 'none';
            return true;
        }

        // ========================================
        // Load Stored Contact Info
        // ========================================
        function loadStoredContactInfo() {
            const storedPhone = localStorage.getItem('user_phone');

            if (storedPhone) {
                document.getElementById('phoneInput').value = storedPhone;
            }

            validateForm();
        }

        // ========================================
        // Phone Number Formatting
        // ========================================
        function formatPhoneNumber(e) {
            let value = e.target.value.replace(/[^0-9]/g, '');
            
            if (value.length <= 3) {
                e.target.value = value;
            } else if (value.length <= 7) {
                e.target.value = value.slice(0, 3) + '-' + value.slice(3);
            } else if (value.length <= 11) {
                e.target.value = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7);
            } else {
                e.target.value = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7, 11);
            }
        }

        // ========================================
        // Handle Files
        // ========================================
        function handleFiles(files) {
            for (let file of files) {
                if (file.size > 10 * 1024 * 1024) {
                    showError('ÌååÏùº ÌÅ¨Í∏∞Îäî 10MB Ïù¥ÌïòÏó¨Ïïº Ìï©ÎãàÎã§.');
                    continue;
                }

                if (!file.type.startsWith('image/') && file.type !== 'application/pdf') {
                    showError('Ïù¥ÎØ∏ÏßÄ(JPG, PNG) ÎòêÎäî PDF ÌååÏùºÎßå ÏóÖÎ°úÎìú Í∞ÄÎä•Ìï©ÎãàÎã§.');
                    continue;
                }

                uploadedFiles.push(file);
            }

            renderUploadedFiles();
            validateForm();
        }

        // ========================================
        // Render Uploaded Files
        // ========================================
        function renderUploadedFiles() {
            const container = document.getElementById('uploadedFiles');
            
            if (uploadedFiles.length === 0) {
                container.innerHTML = '';
                return;
            }

            container.innerHTML = uploadedFiles.map((file, index) => `
                <div class="uploaded-file">
                    ${getFilePreview(file, index)}
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${formatFileSize(file.size)}</div>
                    </div>
                    <button class="remove-file" onclick="removeFile(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');

            uploadedFiles.forEach((file, index) => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const previewImg = document.getElementById(`preview-${index}`);
                        if (previewImg) {
                            previewImg.src = e.target.result;
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function getFilePreview(file, index) {
            if (file.type.startsWith('image/')) {
                return `<img id="preview-${index}" class="file-preview" src="" alt="Preview">`;
            } else {
                return `<i class="fas fa-file-pdf file-icon"></i>`;
            }
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            renderUploadedFiles();
            validateForm();
        }

        // ========================================
        // Validate Form (Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ùÎ∞©Î≤ï Í∏∞Î∞ò)
        // ========================================
        function validateForm() {
            const phone = document.getElementById('phoneInput').value.trim();
            const privacyChecked = document.getElementById('privacyCheck').checked;

            // Ï†ÑÌôîÎ≤àÌò∏ ÌòïÏãù Í≤ÄÏ¶ù (11ÏûêÎ¶¨)
            const phoneDigits = phone.replace(/[^0-9]/g, '');
            const hasValidPhone = phoneDigits.length === 11 && phoneDigits.startsWith('010');
            let isValid = hasValidPhone && privacyChecked;

            // Ï∂îÏ≤ú Ìï≠Î™©Îßå ÏÑ†ÌÉùÌïú Í≤ΩÏö∞
            if (selectedQualifications.length === 1 && selectedQualifications[0] === 'Ï∂îÏ≤ú') {
                isValid = isValid && couponVerified;
            } else {
                // Ìï≠Î™©Î≥Ñ Í≤ÄÏ¶ù (Í∞Å Ìï≠Î™©Ïùò Ïù∏Ï¶ùÎ∞©Î≤ïÏóê Îî∞Îùº)
                let allFieldsValid = true;
                
                selectedQualifications.forEach(qual => {
                    if (qual === 'Ï∂îÏ≤ú') return; // Ï∂îÏ≤úÏùÄ Î≥ÑÎèÑ Ï≤òÎ¶¨
                    
                    const data = qualificationData[qual];
                    const qualFields = qualificationFields[qual];
                    const authMethod = qualFields?.authMethod || 'upload';
                    
                    // ÌòÑÏû• Ïù∏Ï¶ù ÏÑ†ÌÉù Ïãú Ìï¥Îãπ Ìï≠Î™©ÏùÄ Ï∂îÍ∞Ä Í≤ÄÏ¶ù ÏóÜÏùå
                    if (authMethod === 'onsite') return;
                    
                    // ÏßÄÍ∏à Ï≤®Î∂Ä ÏÑ†ÌÉù Ïãú ÌïÑÏàò ÌïÑÎìú Í≤ÄÏ¶ù
                    if (authMethod === 'upload' && data && data.fields) {
                        data.fields.forEach(field => {
                            if (field.required) {
                                const fieldData = qualFields?.fields?.[field.id];
                                
                                if (field.type === 'platform') {
                                    // SNS ÌîåÎû´Ìèº ÏÑ†ÌÉù ÌïÑÏàò
                                    if (!fieldData || !fieldData.value) {
                                        allFieldsValid = false;
                                    }
                                } else if (field.type === 'sns_input') {
                                    // SNS Í≥ÑÏ†ï Ï†ïÎ≥¥ ÌïÑÏàò
                                    const accountData = qualFields?.fields?.sns_account;
                                    if (!accountData || !accountData.value?.trim()) {
                                        allFieldsValid = false;
                                    }
                                } else if (field.type === 'text') {
                                    if (!fieldData || !fieldData.value?.trim()) {
                                        allFieldsValid = false;
                                    }
                                } else if (field.type === 'file') {
                                    // ÌïÑÏàò ÌååÏùº (ÌòÑÏû¨ Î™®Îì† ÌååÏùºÏùÄ ÏÑ†ÌÉù)
                                    if (!fieldData || !fieldData.file) {
                                        allFieldsValid = false;
                                    }
                                }
                            }
                        });
                    }
                });
                
                isValid = isValid && allFieldsValid;
            }

            document.getElementById('submitBtn').disabled = !isValid;
            hideError();
        }

        // ========================================
        // Show/Hide Error
        // ========================================
        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }

        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }

        // ========================================
        // Handle Submit (Ìï≠Î™©Î≥Ñ Ïù∏Ï¶ùÎ∞©Î≤ï Í∏∞Î∞ò)
        // ========================================
        async function handleSubmit() {
            const phone = document.getElementById('phoneInput').value.trim();

            // Validate phone format
            const phoneDigits = phone.replace(/[^0-9]/g, '');
            if (phoneDigits.length !== 11 || !phoneDigits.startsWith('010')) {
                showError('Ïò¨Î∞îÎ•∏ Ï†ÑÌôîÎ≤àÌò∏ ÌòïÏãùÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Ï†ÑÌôîÎ≤àÌò∏ ÌòïÏãù ÌÜµÏùº (010-XXXX-XXXX)
            const formattedPhone = phoneDigits.substring(0, 3) + '-' + phoneDigits.substring(3, 7) + '-' + phoneDigits.substring(7);

            setLoading(true);

            try {
                // Store contact info
                localStorage.setItem('user_phone', formattedPhone);

                // Prepare data
                let snsLink = '';
                let couponCode = '';
                let hostName = '';
                let referralReason = '';

                // Ï∂îÏ≤ú Ìï≠Î™©Îßå ÏÑ†ÌÉùÌïú Í≤ΩÏö∞ ÌäπÎ≥Ñ Ï≤òÎ¶¨
                if (selectedQualifications.length === 1 && selectedQualifications[0] === 'Ï∂îÏ≤ú') {
                    couponCode = document.getElementById('couponInput').value.trim().toUpperCase();
                }

                // Ìï≠Î™©Î≥Ñ Îç∞Ïù¥ÌÑ∞ ÏàòÏßë Î∞è ÌååÏùº ÏóÖÎ°úÎìú (ÏÉà Íµ¨Ï°∞)
                let fieldDataJson = {};  // { ÏûêÍ≤©Î™Ö: { authMethod, fields: {...}, onsiteDocs } }
                let hasUpload = false;
                let hasOnsite = false;
                
                for (const qual of selectedQualifications) {
                    if (qual === 'Ï∂îÏ≤ú') continue;
                    
                    const qualData = qualificationFields[qual];
                    const data = qualificationData[qual];
                    if (!qualData) continue;
                    
                    const authMethod = qualData.authMethod || 'upload';
                    fieldDataJson[qual] = {
                        authMethod: authMethod,
                        onsiteDocs: data.onsiteDocs || '',
                        fields: {}
                    };
                    
                    if (authMethod === 'onsite') {
                        hasOnsite = true;
                        continue;  // ÌòÑÏû•Ïù∏Ï¶ùÏùÄ ÌååÏùº ÏóÖÎ°úÎìú ÏóÜÏùå
                    }
                    
                    hasUpload = true;
                    const fields = qualData.fields || {};
                    
                    for (const [fieldId, fieldData] of Object.entries(fields)) {
                        if (fieldData.type === 'text') {
                            fieldDataJson[qual].fields[fieldId] = { type: 'text', value: fieldData.value };
                            
                            // SNS ÎßÅÌÅ¨ ÌäπÎ≥Ñ Ï≤òÎ¶¨
                            if (fieldId === 'sns_account' && fieldData.link) {
                                snsLink = fieldData.link;
                                fieldDataJson[qual].fields[fieldId].link = fieldData.link;
                            }
                        } else if (fieldData.type === 'file' && fieldData.file) {
                            // ÌååÏùº ÏóÖÎ°úÎìú
                            try {
                                const fileBase64 = await fileToBase64(fieldData.file);
                                const uploadRes = await fetch(FILE_UPLOAD_GAS_URL, {
                                    method: 'POST',
                                    redirect: 'follow',
                                    body: JSON.stringify({
                                        action: 'uploadFiles',
                                        phone: formattedPhone,
                                        files: [{
                                            name: `${qual}_${fieldId}_${fieldData.file.name}`,
                                            type: fieldData.file.type,
                                            size: fieldData.file.size,
                                            data: fileBase64
                                        }],
                                        folder: 'verification'
                                    })
                                });
                                const uploadResult = await uploadRes.json();
                                if (uploadResult.success && uploadResult.files && uploadResult.files[0]) {
                                    fieldDataJson[qual].fields[fieldId] = { type: 'file', url: uploadResult.files[0].url, name: fieldData.file.name };
                                }
                            } catch (uploadError) {
                                console.error(`ÌååÏùº ÏóÖÎ°úÎìú Ïò§Î•ò (${qual}/${fieldId}):`, uploadError);
                            }
                        }
                    }
                }
                
                // fileLinksÏóê Ìï≠Î™©Î≥Ñ Îç∞Ïù¥ÌÑ∞ JSON Î¨∏ÏûêÏó¥Î°ú Ï†ÄÏû•
                const fileLinks = JSON.stringify(fieldDataJson);
                
                // authType Í≤∞Ï†ï (Î≥µÌï©Ïùº Í≤ΩÏö∞ mixed)
                let authType = 'upload';
                if (selectedQualifications.length === 1 && selectedQualifications[0] === 'Ï∂îÏ≤ú') {
                    authType = 'coupon';
                } else if (hasUpload && hasOnsite) {
                    authType = 'mixed';  // ÏùºÎ∂ÄÎäî ÏßÄÍ∏à Ï≤®Î∂Ä, ÏùºÎ∂ÄÎäî ÌòÑÏû•
                } else if (hasOnsite && !hasUpload) {
                    authType = 'onsite';
                }

                // ÏäπÏù∏ÏÉÅÌÉú Í≤∞Ï†ï
                let approvalStatus = 'Ïù∏Ï¶ùÎåÄÍ∏∞';
                if (authType === 'coupon') approvalStatus = 'Ïø†Ìè∞ÏäπÏù∏';
                else if (authType === 'host_referral') approvalStatus = 'ÏäπÏù∏ÏôÑÎ£å';
                else if (authType === 'mixed') approvalStatus = 'ÏÑúÎ•òÏ†úÏ∂úÏôÑÎ£å(ÏùºÎ∂ÄÌòÑÏû•)';
                else if (hasUpload) approvalStatus = 'ÏÑúÎ•òÏ†úÏ∂úÏôÑÎ£å';
                else if (authType === 'onsite') approvalStatus = 'ÌòÑÏû•Ïù∏Ï¶ùÏòàÏ†ï';

                // RESTful APIÎ°ú Ï¥àÎåÄÏû• Ïã†Ï≤≠ Ï†ÄÏû•
                const invitationId = 'INV-' + Date.now();
                const invitationData = {
                    id: invitationId,
                    phone: formattedPhone,
                    qualifications: selectedQualifications.join(', '),
                    groups: selectedGroups.join(', '),
                    wineBonus: wineBonus,
                    authType: authType || '',
                    snsLink: snsLink,
                    fileLinks: fileLinks,
                    couponCode: couponCode,
                    hostName: hostName,
                    referralReason: referralReason,
                    distributor: localStorage.getItem('invitation_source') || '',
                    approvalStatus: approvalStatus
                };

                // Edge FunctionÏúºÎ°ú Ï†ÄÏû• (Î≥¥Ïïà Í∞ïÌôî)
                const EDGE_FUNCTION_URL = 'https://bqpxdxsgxoapguknxwul.supabase.co/functions/v1/submit-invitation';
                
                const edgeResponse = await fetch(EDGE_FUNCTION_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    },
                    body: JSON.stringify(invitationData)
                });
                
                if (!edgeResponse.ok) {
                    const errData = await edgeResponse.json();
                    console.error('Edge Function Ïò§Î•ò:', errData);
                }
                
                // GAS Ïä§ÌîÑÎ†àÎìúÏãúÌä∏Ïóê Î∞±ÏóÖ
                try {
                    await fetch(BACKUP_GAS_URL, {
                        method: 'POST',
                        redirect: 'follow',
                        body: JSON.stringify({
                            action: 'backupInvitation',
                            invitation: invitationData
                        })
                    });
                } catch (backupError) {
                    console.error('Ï¥àÎåÄÏû• Î∞±ÏóÖ Ïò§Î•ò:', backupError);
                }

                // Ï¥àÎåÄÏû• Ïã†Ï≤≠ ÏôÑÎ£å Î¨∏Ïûê Î∞úÏÜ°
                try {
                    await fetch(BACKUP_GAS_URL, {
                        method: 'POST',
                        redirect: 'follow',
                        body: JSON.stringify({
                            action: 'sendInvitationCompleteSms',
                            to: formattedPhone
                        })
                    });
                } catch (smsError) {
                    console.error('Î¨∏Ïûê Î∞úÏÜ° Ïò§Î•ò:', smsError);
                }

                // Redirect to success page
                const successParams = new URLSearchParams({
                    qualifications: selectedQualifications.join(','),
                    authType: authType,
                    phone: formattedPhone,
                    wineBonus: wineBonus ? 'true' : 'false'
                });
                window.location.href = `success.html?${successParams.toString()}`;

            } catch (error) {
                console.error('Submit error:', error);
                showError('Ï†úÏ∂ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
            } finally {
                setLoading(false);
            }
        }

        // ========================================
        // File to Base64 (ÏàúÏàò base64Îßå Î∞òÌôò)
        // ========================================
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    // data:image/png;base64,XXXX ÏóêÏÑú base64 Î∂ÄÎ∂ÑÎßå Ï∂îÏ∂ú
                    const result = reader.result;
                    const base64 = result.split(',')[1];
                    resolve(base64);
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // ========================================
        // Loading State
        // ========================================
        function setLoading(loading) {
            const submitBtn = document.getElementById('submitBtn');
            const spinner = document.getElementById('loadingSpinner');
            const submitText = document.getElementById('submitText');
            const submitIcon = document.getElementById('submitIcon');

            if (loading) {
                submitBtn.disabled = true;
                spinner.style.display = 'inline-block';
                submitText.textContent = 'Ï≤òÎ¶¨ Ï§ë...';
                submitIcon.style.display = 'none';
            } else {
                validateForm();
                spinner.style.display = 'none';
                submitText.textContent = 'Ïã†Ï≤≠ ÏôÑÎ£åÌïòÍ∏∞';
                submitIcon.style.display = 'inline';
            }
        }
    </script>
</body>
</html>
